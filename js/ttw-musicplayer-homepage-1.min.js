!function(a){a.fn.ttwMusicPlayer=function(b,c){function p(a){return w(n[a].title)?w(n[a].mp3)?w(n[a].oga)?"":q(n[a].oga):q(n[a].mp3):n[a].title}function q(a){return a=a.split("/"),a[a.length-1]}function r(a,b,c){if("track"==a)w(n[c].rating)||t(b,n[c].rating);else{var d=w(n[c].rating)?0:Math.ceil(n[c].rating);s(d)}}function s(a){d.find(g.trackInfo).find(g.ratingLevel).removeClass(u(g.ratingLevelOn)).slice(0,a).addClass(u(g.ratingLevelOn))}function t(a,b){a.find(g.ratingLevel).removeClass(u(g.ratingLevelOn)).slice(0,2*b).addClass(u(g.ratingLevelOn))}function u(a){return a.substr(1)}function w(a){return"undefined"==typeof a}var e,f,g,h,i,j,k,b,l,m,n,o,d=this;g={jPlayer:"#jquery_jplayer",jPlayerInterface:".jp-interface",playerPrevious:".jp-interface .jp-previous",playerNext:".jp-interface .jp-next",trackList:".tracklist",tracks:".tracks",track:".track",trackRating:".rating-bar",trackInfo:".track-info",rating:".rating",ratingLevel:".rating-level",ratingLevelOn:".on",rating_succes:".rating-succes",title:".title",duration:".duration",buy:".buy",buyNotActive:".not-active",playing:".playing",moreButton:".more",player:".player",artist:".artist",artistOuter:".artist-outer",albumCover:".img",description:".description",descriptionShowing:".showing"},e={ratingCallback:null,currencySymbol:"$",buyText:"BUY",tracksToShow:5,autoplay:!1,jPlayer:{}},f=a.extend(!0,{},e,c),n=b,o=0,h=function(){b=new i,l=new j,l.buildInterface(),b.init(f.jPlayer),d.bind("mbPlaylistLoaded",function(){d.bind("mbInterfaceBuilt",function(){m=new k}),l.init()})},i=function(){function m(c){e=a(".ttw-music-player .jPlayer-container");var i,j;i={swfPath:"jquery-jplayer",supplied:"mp3, oga",solution:"html, flash",cssSelectorAncestor:g.jPlayerInterface,errorAlerts:!1,warningAlerts:!1},j=a.extend(!0,{},i,c),e.bind(a.jPlayer.event.ready,function(){e.bind(a.jPlayer.event.ended,function(a){v()}),e.bind(a.jPlayer.event.play,function(a){e.jPlayer("pauseOthers"),h.eq(o).addClass(u(g.playing)).siblings().removeClass(u(g.playing))}),e.bind(a.jPlayer.event.playing,function(a){b=!0}),e.bind(a.jPlayer.event.pause,function(a){b=!1}),a(g.playerPrevious).click(function(){return x(),a(this).blur(),!1}),a(g.playerNext).click(function(){return v(),a(this).blur(),!1}),d.bind("mbInitPlaylistAdvance",function(a){var b=this.getData("mbInitPlaylistAdvance");b!=o?(o=b,t(o)):e.data("jPlayer").status.srcSet?y():t(0)}),z(),d.trigger("mbPlaylistLoaded"),q(f.autoplay)}),e.jPlayer(j)}function q(a){o=0,a?t(o):(s(o),d.trigger("mbPlaylistInit"))}function s(a){o=a,e.jPlayer("setMedia",n[o])}function t(a){s(a),a>=f.tracksToShow&&A(),d.trigger("mbPlaylistAdvance"),e.jPlayer("play")}function v(){var a=o+1<n.length?o+1:0;t(a)}function x(){var a=o-1>=0?o-1:n.length-1;t(a)}function y(){b?e.jPlayer("pause"):e.jPlayer("play")}function z(){var b=a();k=d.find(g.tracks);for(var e=0;e<10;e++)b=b.add(c.ratingBar);for(var m=0;m<n.length;m++){var o=a(c.listItem);o.find(g.rating).html(b.clone()),o.find(g.title).html(p(m)),o.find(g.duration).html(B(m)),r("track",o,m),C(o,m),o.data("index",m),k.append(o)}if(h=a(g.track),h.slice(0,f.tracksToShow).each(function(){i+=a(this).outerHeight()}),h.slice(f.tracksToShow,n.length).each(function(){j+=a(this).outerHeight()}),j>0){var q=a(g.trackList);k.height(i),q.addClass("show-more-button"),q.find(g.moreButton).click(function(){l=a(this),A()})}h.find(".title").click(function(){t(a(this).parents("li").data("index"))})}function A(){w(l)&&(l=d.find(g.moreButton)),k.animate({height:i+j},function(){l.animate({opacity:0},function(){l.slideUp(function(){l.parents(g.trackList).removeClass("show-more-button"),l.remove()})})})}function B(a){return w(n[a].duration)?"-":n[a].duration}function C(a,b){w(n[b].buy)||a.find(g.buy).removeClass(u(g.buyNotActive)).attr("href",n[b].buy).html(D(b))}function D(a){return(w(n[a].price)?"":f.currencySymbol+n[a].price)+" "+f.buyText}var c,h,k,l,b=!1,e={},i=0,j=0;return c={listItem:'<li class="track"><span class="title"></span><span class="duration"></span><a href="#" class="buy not-active" target="_blank"></a></li>',ratingBar:'<span class="rating-level rating-bar"></span>'},{init:m,playlistInit:q,playlistAdvance:t,playlistNext:v,playlistPrev:x,togglePlay:y,$myJplayer:e}},k=function(){function c(){a(g.rating_succes).css("display","none"),a(g.ratingLevel).click(function(){var b=a(this),c=b.parent().children().index(b)+1,e=a(g.title+":first").text(),f="action=my_special_ajax_call5&rating="+c+"&trackname="+e;jQuery.ajax({type:"POST",url:ajaxurl,cache:!1,data:f,beforeSend:function(){},success:function(b){a(g.rating_succes).html(b).fadeIn(500).delay(1e3).fadeOut(500)}}),b.prevAll().add(b).addClass(u(g.ratingLevelOn)).end().end().nextAll().removeClass(u(g.ratingLevelOn))})}d.find(g.track);a(g.rating).find(g.ratingLevel).hover(function(){a(this).addClass("hover").prevAll().addClass("hover").end().nextAll().removeClass("hover")}),a(g.rating).mouseleave(function(){a(this).find(g.ratingLevel).removeClass("hover")}),c()},j=function(){function i(){b=a(g.player),c=b.find(g.title),e=b.find(g.artist),h=b.find(g.albumCover),q(),d.bind("mbPlaylistAdvance mbPlaylistInit",function(){k(),l(),r("current",null,o),m()})}function j(){var b,c;b='<div class="ttw-music-player"><div class="player jp-interface"><div class="album-cover"><span class="img"></span>            <span class="highlight"></span>        </div>        <div class="track-info">            <p class="title"></p>            <p class="artist-outer">By <span class="artist"></span></p>            <div class="rating">                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star on"></span>                <span class="rating-level rating-star"></span>\t\t\t\t <span class="rating-succes">Already rated</span>            </div>        </div>        <div class="player-controls">            <div class="main">                <div class="previous jp-previous"></div>                <div class="play jp-play"></div>                <div class="pause jp-pause"></div>                <div class="next jp-next"></div><!-- These controls aren\'t used by this plugin, but jPlayer seems to require that they exist -->                <span class="unused-controls">                    <span class="jp-video-play"></span>                    <span class="jp-stop"></span>                    <span class="jp-mute"></span>                    <span class="jp-unmute"></span>                    <span class="jp-volume-bar"></span>                    <span class="jp-volume-bar-value"></span>                    <span class="jp-volume-max"></span>                    <span class="jp-current-time"></span>                    <span class="jp-duration"></span>                    <span class="jp-full-screen"></span>                    <span class="jp-restore-screen"></span>                    <span class="jp-repeat"></span>                    <span class="jp-repeat-off"></span>                    <span class="jp-gui"></span>                </span>            </div>            <div class="progress-wrapper">                <div class="progress jp-seek-bar">                    <div class="elapsed jp-play-bar"></div>                </div>            </div>        </div>    </div>    <div class="tracklist">        <ol class="tracks"> </ol>        <div class="more">View More...</div>    </div>    <div class="jPlayer-container"></div></div>',c=a(b).css({display:"none",opacity:0}).appendTo(d).slideDown("slow",function(){c.animate({opacity:1}),d.trigger("mbInterfaceBuilt")})}function k(){c.html(p(o))}function l(){w(n[o].artist)?e.parent(g.artistOuter).animate({opacity:0},"fast"):e.html(n[o].artist).parent(g.artistOuter).animate({opacity:1},"fast")}function m(){h.animate({opacity:0},"fast",function(){if(!w(n[o].cover)){var a=o;a==o&&h.css({opacity:1}).html('<img src="'+n[o].cover+'" alt="album cover" />')}})}function q(){w(f.description)||d.find(g.description).html(f.description).addClass(u(g.descriptionShowing)).slideDown()}var b,c,e,h;return{buildInterface:j,init:i}},h()}}(jQuery),function(a){a.fn.imagesLoaded=function(a){var b=this.filter("img"),c=b.length;return b.bind("load",function(){--c<=0&&a.call(b,this)}).each(function(){if(this.complete||void 0===this.complete){var a=this.src;this.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",this.src=a}}),this}}(jQuery);var myPlaylist=[{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Energy",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"3:30",cover:"images/youngfree.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Pursue",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"7:03",cover:"images/beat_exchange.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"This Is Living (Acoustic)",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"4:24",cover:"images/beat_exchange.jpg"},{mp3:"media/Dream-Music-Relax.mp3",oga:"media/Dream-Music-Relax.ogg",title:"Sinking Deep",artist:"Young & Free",rating:"5",buy:"Buy",price:"123",duration:"4:07",cover:"images/youngfree.jpg"}];jQuery(document).ready(function(){jQuery("#myplayer").ttwMusicPlayer(myPlaylist,{currencySymbol:"",description:"",buyText:"",tracksToShow:4,autoplay:!1})});
